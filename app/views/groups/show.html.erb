<% if @message %>
  <%= render 'layouts/error_messages', model: @message %>
<% end %>

<div style="background-color: rgba(255,0,0,0.1);">
  <%= image_tag @group.background_image.url, alt: 'background img', class: 'w-100', height: 100, style: "object-fit: cover;"  %>
</div>

<div class="d-flex align-items-center mt-3">
  <%= image_tag @group.image.url, alt: 'background image', size: '44x44', style: "object-fit: contain;"  %>
  <h2 class="mb-0 ml-2">
    <%= @group.name %>
  </h2>
  <div class="ml-auto">
    <% if current_user == @group.user %>
      <%= link_to '編集する', edit_group_path, class: 'btn btn-outline-primary btn-sm' %>
      <%= link_to "削除する", group_url, method: :delete, data: { confirm: "グループを削除しますか?" }, class: 'btn btn-outline-danger btn-sm' %>
    <% else %>
      <% unless @group.subscriber?(current_user) %>
        <%= form_with(model: @group.subscribers.build, local: true) do |f| %>
          <%= hidden_field_tag :group_token, @group.token %>
          <%= f.submit '参加する', class: 'btn btn-outline-primary btn-lg' %>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>
<div class="border mb-5 p-3">
  <%= @group.description %>
</div>
<div class="pb-5">
  <% if @messages %>
    <% @messages.each do |message| %>
      <div class="d-flex align-items-center mb-3 p-1">
        <%= image_tag message.user.image.url, alt: 'user icon', size: '40x40', style: "object-fit: contain;" %>
        <div class="pl-3">
          <%= message.content %>
        </div>
      </div>
    <% end %>
    <%= paginate @messages %>
  <% end %>
</div>
<div class="fixed-bottom">
  <div class="container">
    <div class="border rounded">
      <%= form_with(model: @group.messages.build, local: true) do |f| %>
        <div class="d-flex">
          <%= f.text_area :content, rows: 1, class: 'form-control border-0', style: 'resize: none' %>
          <%= hidden_field_tag :group_token, @group.token %>
          <%= f.submit '送信', class: 'btn btn-primary mr-2 my-1' %>
        </div>
      <% end %>
    </div>
  </div>
</div>